# [게리맨더링 2](https://www.acmicpc.net/problem/17779)

<div align = center>

| 시간 제한 | 메모리 제한 | 제출  | 정답 | 맞은 사람 | 정답 비율 |
| :-------- | :---------- | :---- | :--- | :-------- | :-------- |
| 1 초      | 512 MB      | 10441 | 6079 | 3780      | 56.300%   |

</div>

### 문제

재현시의 시장 구재현은 지난 몇 년간 게리맨더링을 통해서 자신의 당에게 유리하게 선거구를 획정했다. 견제할 권력이 없어진 구재현은 권력을 매우 부당하게 행사했고, 심지어는 시의 이름도 재현시로 변경했다. 이번 선거에서는 최대한 공평하게 선거구를 획정하려고 한다.

재현시는 크기가 N×N인 격자로 나타낼 수 있다. 격자의 각 칸은 구역을 의미하고, r행 c열에 있는 구역은 (r, c)로 나타낼 수 있다. 구역을 다섯 개의 선거구로 나눠야 하고, 각 구역은 다섯 선거구 중 하나에 포함되어야 한다. 선거구는 구역을 적어도 하나 포함해야 하고, 한 선거구에 포함되어 있는 구역은 모두 연결되어 있어야 한다. 구역 A에서 인접한 구역을 통해서 구역 B로 갈 수 있을 때, 두 구역은 연결되어 있다고 한다. 중간에 통하는 인접한 구역은 0개 이상이어야 하고, 모두 같은 선거구에 포함된 구역이어야 한다.

선거구를 나누는 방법은 다음과 같다.

1. 기준점 (x, y)와 경계의 길이 d<sub>1</sub>, d<sub>2</sub>를 정한다. (d<sub>1</sub>, d<sub>2</sub> ≥ 1, 1 ≤ x < x+d<sub>1</sub>+d<sub>2</sub> ≤ N, 1 ≤ y-d<sub>1</sub> < y < y+d<sub>2</sub> ≤ N)

2. 다음 칸은 경계선이다.

   1. (x, y), (x+1, y-1), ..., (x+d<sub>1</sub>, y-d<sub>1</sub>)

   2. (x, y), (x+1, y+1), ..., (x+d<sub>2</sub>, y+d<sub>2</sub>)

   3. (x+d<sub>1</sub>, y-d<sub>1</sub>), (x+d<sub>1</sub>+1, y-d<sub>1</sub>+1), ... (x+d<sub>1</sub>+d<sub>2</sub>, y-d<sub>1</sub>+d<sub>2</sub>)

   4. (x+d<sub>2</sub>, y+d<sub>2</sub>), (x+d<sub>2</sub>+1, y+d<sub>2</sub>-1), ..., (x+d<sub>2</sub>+d<sub>1</sub>, y+d<sub>2</sub>-d<sub>1</sub>)

3. 경계선과 경계선의 안에 포함되어있는 곳은 5번 선거구이다.

4. 5번 선거구에 포함되지 않은 구역 (r, c)의 선거구 번호는 다음 기준을 따른다.

   - 1번 선거구: 1 ≤ r < x+d<sub>1</sub>, 1 ≤ c ≤ y

   - 2번 선거구: 1 ≤ r ≤ x+d<sub>2</sub>, y < c ≤ N

   - 3번 선거구: x+d<sub>1</sub> ≤ r ≤ N, 1 ≤ c < y-d<sub>1</sub>+d<sub>2</sub>

   - 4번 선거구: x+d<sub>2</sub> < r ≤ N, y-d<sub>1</sub>+d<sub>2</sub> ≤ c ≤ N

아래는 크기가 7×7인 재현시를 다섯 개의 선거구로 나눈 방법의 예시이다.

<div align=center>
  <table>
    <tr>
      <td align=center><img src="https://upload.acmicpc.net/c144c31e-db45-4094-9c1d-0656a690aef0/-/preview/" width="300" height="303"/></td>
      <td align=center><img src="https://upload.acmicpc.net/813c38e0-3197-4589-bc96-17d96eb9ed14/-/preview/" width="300" height="305"/></td>
      <td align=center><img src="https://upload.acmicpc.net/892417dd-b824-4d4e-8bce-2faf341a9f66/-/preview/" width="300" height="302"/></td>
    </tr>
    <tr>
      <td align=center>x = 2, y = 4, d1 = 2, d2 = 2</td>
      <td align=center>x = 2, y = 5, d1 = 3, d2 = 2</td>
      <td align=center>x = 4, y = 3, d1 = 1, d2 = 1</td>
    </tr>
  </table>
</div>

구역 (r, c)의 인구는 A[r][c]이고, 선거구의 인구는 선거구에 포함된 구역의 인구를 모두 합한 값이다. 선거구를 나누는 방법 중에서, 인구가 가장 많은 선거구와 가장 적은 선거구의 인구 차이의 최솟값을 구해보자.

---

### 입력

첫째 줄에 재현시의 크기 N이 주어진다.

둘째 줄부터 N개의 줄에 N개의 정수가 주어진다. r행 c열의 정수는 A[r][c]를 의미한다.

---

### 출력

첫째 줄에 인구가 가장 많은 선거구와 가장 적은 선거구의 인구 차이의 최솟값을 출력한다.

---

### 예제 입력

| 예제 입력1                                                                                        | 예제 출력1 |
| :------------------------------------------------------------------------------------------------ | :--------- |
| 6<br/>1 2 3 4 1 6<br/>7 8 9 1 4 2<br/>2 3 4 1 1 3<br/>6 6 6 6 9 4<br/>9 1 9 1 9 5<br/>1 1 1 1 9 9 | 18         |

<div align=center>
  <img src="https://upload.acmicpc.net/4ed91e95-51eb-461b-979a-fce236c79094/-/preview/" widht="250" height="251"/>
</div>

| 예제 입력2                                                                                        | 예제 출력2 |
| :------------------------------------------------------------------------------------------------ | :--------- |
| 6<br/>5 5 5 5 5 5<br/>5 5 5 5 5 5<br/>5 5 5 5 5 5<br/>5 5 5 5 5 5<br/>5 5 5 5 5 5<br/>5 5 5 5 5 5 | 20         |

| 예제 입력3                                                                                                                                                        | 예제 출력3 |
| :---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------- |
| 8<br/>1 2 3 4 5 6 7 8<br/>2 3 4 5 6 7 8 9<br/>3 4 5 6 7 8 9 1<br/>4 5 6 7 8 9 1 2<br/>5 6 7 8 9 1 2 3<br/>6 7 8 9 1 2 3 4<br/>7 8 9 1 2 3 4 5<br/>8 9 1 2 3 4 5 6 | 23         |

<div align=center>
  <img src="https://upload.acmicpc.net/760daa25-5f4b-4077-825c-ba208a99ab6f/-/preview/" width="350" height="353"/>
</div>

---

### 문제 접근

- 주어진 배열 크기만큼 전체 순회하면서, 경계선에서 4개의 꼭짓점을 찾음

- 꼭짓점 4개가 모두 배열 안에 존재하는 경우, 4개의 꼭짓점을 기준으로 선거구를 나눔

- 나눠진 선거구를 기준으로 인구수를 구한 후, 인구수 차이값의 최소값을 출력
